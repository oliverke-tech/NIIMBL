<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutorial &mdash; vLab 0.2.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "tags": "ams", "useLabelIds": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Bioreactor module" href="../IntegratedBioprocess/Bioreactor.html" />
    <link rel="prev" title="Statistical Modeling" href="../TrainingMaterial/StatisticalModel/statistical_model.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> vLab
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Lectures</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../TrainingMaterial/process_modeling.html">Bioprocess Modeling</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorial</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#background">Background</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#n-linked-glycosylation-simulation">N-linked Glycosylation Simulation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#high-level-model-overview">High Level Model Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#model-description">Model Description</a></li>
<li class="toctree-l4"><a class="reference internal" href="#kinetic-reaction-network-column-reactant-row-product-cell-enzyme">Kinetic Reaction Network: column (reactant), row (product), cell (enzyme)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#plantwise-simulation">Plantwise Simulation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bioreactor-kinetic-model">Bioreactor Kinetic Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#harvest-hold-tank-model">Harvest/Hold Tank Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#chromatography-model">Chromatography Model</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#n-linked-glysycolation-simulation">N-linked Glysycolation Simulation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#steady-state-n-linked-glycosylation-simulation">Steady-State N-linked Glycosylation Simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dynamic-n-linked-glycosylation-simulation">Dynamic N-linked Glycosylation Simulation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#plantwise-simulation">Plantwise Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#raman-spectropecty">Raman Spectropecty</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#raman">Raman</a></li>
<li class="toctree-l3"><a class="reference internal" href="#read-spc-file">Read .spc file</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#read-a-single-file">Read a single file</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#read-dx-spectral-files">Read .dx spectral files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#read-a-single-dx-file">Read a single .dx file</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#read-csv-files">Read .csv files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spectra-preprocessing">Spectra preprocessing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#msc">MSC</a></li>
<li class="toctree-l4"><a class="reference internal" href="#snv-and-detrend">SNV and Detrend</a></li>
<li class="toctree-l4"><a class="reference internal" href="#savitzky-golay">Savitzky - Golay</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#split-the-dataset">Split The Dataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#split-the-dataset-into-training-70-and-testing-30-sets">split the dataset into training (70%) and testing (30%) sets</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#raman-spectra-data-analysis">Raman Spectra Data Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ridge-regression">Ridge Regression</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lasso-regression">Lasso Regression</a></li>
<li class="toctree-l4"><a class="reference internal" href="#elastic-net">Elastic Net</a></li>
<li class="toctree-l4"><a class="reference internal" href="#principal-components-regression">Principal Components Regression</a></li>
<li class="toctree-l4"><a class="reference internal" href="#partial-least-squares-pls-regression">Partial least-squares (PLS) regression</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Integrated Bioprocess</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../IntegratedBioprocess/Bioreactor.html">Bioreactor module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../IntegratedBioprocess/Chromatography.html">Chromatography module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../IntegratedBioprocess/HarvestTank.html">HarvestTank module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../IntegratedBioprocess/ODESolver.html">ODESolver module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../IntegratedBioprocess/Plantwise.html">Plantwise module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../IntegratedBioprocess/PlantwiseSimulator.html">PlantwiseSimulator module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../IntegratedBioprocess/Util.html">Util module</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Steady-State Glycosylation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../PerfusionSimulator/PerfusionSimulator.html">PerfusionSimulator package</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Dynamic Glycosylation Simulator</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../DynamicGlycosylationSimulator/DynamicGlycosylationSimulator.html">DynamicGlycosylationSimulator package</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Glycosylation Model Base Class</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../GlycosylationModelBase/GlycosylationModelBase.html">GlycosylationModelBase package</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Raman Spectropecty</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../RamanAnalytics/RamanAnalytics.html">RamanAnalytics package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">vLab</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Tutorial</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/Tutorial/tutorial.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="tutorial">
<h1><a class="toc-backref" href="#id1">Tutorial</a><a class="headerlink" href="#tutorial" title="Permalink to this headline"></a></h1>
<div class="contents topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#tutorial" id="id1">Tutorial</a></p>
<ul>
<li><p><a class="reference internal" href="#background" id="id2">Background</a></p>
<ul>
<li><p><a class="reference internal" href="#n-linked-glycosylation-simulation" id="id3">N-linked Glycosylation Simulation</a></p>
<ul>
<li><p><a class="reference internal" href="#high-level-model-overview" id="id4">High Level Model Overview</a></p></li>
<li><p><a class="reference internal" href="#model-description" id="id5">Model Description</a></p></li>
<li><p><a class="reference internal" href="#kinetic-reaction-network-column-reactant-row-product-cell-enzyme" id="id6">Kinetic Reaction Network: column (reactant), row (product), cell (enzyme)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#plantwise-simulation" id="id7">Plantwise Simulation</a></p>
<ul>
<li><p><a class="reference internal" href="#bioreactor-kinetic-model" id="id8">Bioreactor Kinetic Model</a></p></li>
<li><p><a class="reference internal" href="#harvest-hold-tank-model" id="id9">Harvest/Hold Tank Model</a></p></li>
<li><p><a class="reference internal" href="#chromatography-model" id="id10">Chromatography Model</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#n-linked-glysycolation-simulation" id="id11">N-linked Glysycolation Simulation</a></p>
<ul>
<li><p><a class="reference internal" href="#steady-state-n-linked-glycosylation-simulation" id="id12">Steady-State N-linked Glycosylation Simulation</a></p></li>
<li><p><a class="reference internal" href="#dynamic-n-linked-glycosylation-simulation" id="id13">Dynamic N-linked Glycosylation Simulation</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#plantwise-simulation" id="id14">Plantwise Simulation</a></p></li>
<li><p><a class="reference internal" href="#raman-spectropecty" id="id15">Raman Spectropecty</a></p>
<ul>
<li><p><a class="reference internal" href="#raman" id="id16">Raman</a></p></li>
<li><p><a class="reference internal" href="#read-spc-file" id="id17">Read .spc file</a></p>
<ul>
<li><p><a class="reference internal" href="#read-a-single-file" id="id18">Read a single file</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#read-dx-spectral-files" id="id19">Read .dx spectral files</a></p>
<ul>
<li><p><a class="reference internal" href="#read-a-single-dx-file" id="id20">Read a single .dx file</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#read-csv-files" id="id21">Read .csv files</a></p></li>
<li><p><a class="reference internal" href="#spectra-preprocessing" id="id22">Spectra preprocessing</a></p>
<ul>
<li><p><a class="reference internal" href="#msc" id="id23">MSC</a></p></li>
<li><p><a class="reference internal" href="#snv-and-detrend" id="id24">SNV and Detrend</a></p></li>
<li><p><a class="reference internal" href="#savitzky-golay" id="id25">Savitzky - Golay</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#split-the-dataset" id="id26">Split The Dataset</a></p>
<ul>
<li><p><a class="reference internal" href="#split-the-dataset-into-training-70-and-testing-30-sets" id="id27">split the dataset into training (70%) and testing (30%) sets</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#raman-spectra-data-analysis" id="id28">Raman Spectra Data Analysis</a></p>
<ul>
<li><p><a class="reference internal" href="#ridge-regression" id="id29">Ridge Regression</a></p></li>
<li><p><a class="reference internal" href="#lasso-regression" id="id30">Lasso Regression</a></p></li>
<li><p><a class="reference internal" href="#elastic-net" id="id31">Elastic Net</a></p></li>
<li><p><a class="reference internal" href="#principal-components-regression" id="id32">Principal Components Regression</a></p></li>
<li><p><a class="reference internal" href="#partial-least-squares-pls-regression" id="id33">Partial least-squares (PLS) regression</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<section id="background">
<h2><a class="toc-backref" href="#id2">Background</a><a class="headerlink" href="#background" title="Permalink to this headline"></a></h2>
<section id="n-linked-glycosylation-simulation">
<h3><a class="toc-backref" href="#id3">N-linked Glycosylation Simulation</a><a class="headerlink" href="#n-linked-glycosylation-simulation" title="Permalink to this headline"></a></h3>
<section id="high-level-model-overview">
<h4><a class="toc-backref" href="#id4">High Level Model Overview</a><a class="headerlink" href="#high-level-model-overview" title="Permalink to this headline"></a></h4>
<p>The glycosylation model is based on the cisternal maturation
assumption with recycling of Golgi resident proteins first proposed
by Jimenez del Val et al. (2011). The mass balances for the species
involved were calculated considering the Golgi apparatus as a single
plug flow reactor operating at steady state according to equations (11)-(13) and the
reaction scheme reported in the figure below. The effect of the operating conditions on N-glycosylation was simulated
by linking the kinetics of enzymatic reactions to the availability of
sugar precursors, and the concentrations of metal ions and  ammonia.</p>
<p><img alt="img.png" src="../_images/reaction_network1.png" /></p>
</section>
<section id="model-description">
<h4><a class="toc-backref" href="#id5">Model Description</a><a class="headerlink" href="#model-description" title="Permalink to this headline"></a></h4>
<p>Mass balance equations for the unstructured cell culture model and the mechanistic glycosylation model adapted from
Karst et. al. (2017). The modeling framework can be divided in two sections. The first part comprises a simple
unstructured cell culture model for the estimation of cell  specific parameters (e.g., growth rate, ammonia and antibody
specific productivities) and process related values (e.g., bleed rate). The mass balances of the perfusion bioreactor
are based on the assumption of a CSTR reactor (e.g., perfect mixing).</p>
<p><img alt="img.png" src="../_images/reaction_equations1.png" /></p>
<p><strong>Reference</strong>: Karst, D. J., Scibona, E., Serra, E., Bielser, J. M., Souquet, J., Stettler, M., … &amp; Villiger, T. K.
(2017). Modulation and modeling of monoclonal antibody N‐linked glycosylation in mammalian cell perfusion reactors.
Biotechnology and bioengineering, 114(9), 1978-1990.</p>
</section>
<section id="kinetic-reaction-network-column-reactant-row-product-cell-enzyme">
<h4><a class="toc-backref" href="#id6">Kinetic Reaction Network: column (reactant), row (product), cell (enzyme)</a><a class="headerlink" href="#kinetic-reaction-network-column-reactant-row-product-cell-enzyme" title="Permalink to this headline"></a></h4>
<p><img alt="img.png" src="../_images/reactions1.png" /></p>
</section>
</section>
<section id="plantwise-simulation">
<h3><a class="toc-backref" href="#id7">Plantwise Simulation</a><a class="headerlink" href="#plantwise-simulation" title="Permalink to this headline"></a></h3>
<p><img alt="img.png" src="../_images/plantwise_diagram.png" /></p>
<p><strong>Reference</strong>: Amos E. Lu, Joe A. Paulson, Nicholas J. Mozdzierz, Alan Stockdale, Ashlee N. Ford Versypt,
Kerry R. Lov, J. Christopher Love, Richard D. Braatz (2015). Control Systems Technology in the Advanced Manufacturing
of Biologic Drugs. CCA.</p>
<section id="bioreactor-kinetic-model">
<h4><a class="toc-backref" href="#id8">Bioreactor Kinetic Model</a><a class="headerlink" href="#bioreactor-kinetic-model" title="Permalink to this headline"></a></h4>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\frac{dX}{dt}&amp;=-\frac{F_{in}-F_{out}}{V}X+(\mu_g+\mu_m)X\\
\frac{dS_g}{dt}&amp;=\frac{F_{in}}{V}(S_{in,g}-S_g)-q_{S_g}X\\
\frac{dS_m}{dt}&amp;=\frac{F_{in}}{V}(S_{i,m}-S_m)-q_{S_m}X\\
\frac{dP_i}{dt}&amp;=-\frac{F_{in}}{V}P_i+q_{P_i}X\\
\frac{dV}{dt}&amp;=F_{in}-F_{out}
\end{align*}
\end{split}\]</div>
</section>
<section id="harvest-hold-tank-model">
<h4><a class="toc-backref" href="#id9">Harvest/Hold Tank Model</a><a class="headerlink" href="#harvest-hold-tank-model" title="Permalink to this headline"></a></h4>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\frac{dP_i}{dt}&amp;=-\frac{F_{in}}{V}(P_{i,in}-P_i)\\
\frac{dV}{dt}&amp;=F_{in}-F_{out}
\end{align*}
\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(𝑋\)</span>: biomass<br />
<span class="math notranslate nohighlight">\(𝐹_𝑖𝑛\)</span>: inlet flow rate (L/h)<br />
<span class="math notranslate nohighlight">\(𝐹_𝑜𝑢𝑡\)</span>: outlet flow rate (L/h)<br />
<span class="math notranslate nohighlight">\(𝜇_𝑔\)</span>,<span class="math notranslate nohighlight">\(𝜇_𝑚\)</span>: Specific growth rate<br />
<span class="math notranslate nohighlight">\(𝑆_{𝑖𝑛,𝑔}\)</span>: inlet glycerol concentration (g/L)<br />
<span class="math notranslate nohighlight">\(𝑆_{𝑖𝑛,𝑚}\)</span>: inlet methanol concentration (g/L)<br />
<span class="math notranslate nohighlight">\(𝑆_𝑔\)</span>: glycerol concentration (g/L)<br />
<span class="math notranslate nohighlight">\(𝑆_𝑚\)</span>: methanol concentration (g/L)<br />
<span class="math notranslate nohighlight">\(𝑞_{𝑆_𝑔}\)</span>,<span class="math notranslate nohighlight">\(𝑞_{𝑆_𝑚}\)</span>: Specific rate of substrate consumption (g/g-h)<br />
<span class="math notranslate nohighlight">\(𝑞_{𝑃_𝑖}\)</span>: Specific product production rate (g/g-h)<br />
<span class="math notranslate nohighlight">\(𝑃_𝑖\)</span>: protein <span class="math notranslate nohighlight">\(𝑖\)</span><br />
<span class="math notranslate nohighlight">\(𝑉\)</span>: bioreactor volume (L)</p>
</section>
<section id="chromatography-model">
<h4><a class="toc-backref" href="#id10">Chromatography Model</a><a class="headerlink" href="#chromatography-model" title="Permalink to this headline"></a></h4>
<p>Mobile phase (lipid phase)</p>
<ul class="simple">
<li><p>Nonideal transport model for the concentration of species <span class="math notranslate nohighlight">\(i\)</span>th species</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\frac{\partial C_i}{\partial \theta}\epsilon_{tot}=-\frac{\partial C_i}{dz}+\frac{1}{\text{Pe}}\frac{\partial^2 C_i}{\partial z^2}-\frac{q_i}{\theta}\epsilon_{pore}
\]</div>
<ul class="simple">
<li><p>The mass balance of salt whose concentration is denoted by <span class="math notranslate nohighlight">\(𝐶_{𝑠𝑎𝑙𝑡}\)</span>, is</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\frac{\partial C_{salt}}{\partial \theta}\epsilon_{tot}=-\frac{\partial C_{salt}}{dz}+\frac{1}{\text{Pe}}\frac{\partial^2 C_{salt}}{\partial z^2}
\]</div>
<p>Adsorbed (stationary) phase: the kinetics of the adsorption are</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial q_i}{\partial \theta}=k_{ads,i}C_i \bar{Q}^{v_i}-k_{des,i}q_iC^{v_i}_{salt}.
\]</div>
<p>where <span class="math notranslate nohighlight">\(C_i\)</span> is the concentration of species <span class="math notranslate nohighlight">\(i\)</span> in the liquid phase, <span class="math notranslate nohighlight">\(\theta\)</span> is the dimensionless time,
<span class="math notranslate nohighlight">\(\epsilon_{tot}\)</span> is the total porosity, <span class="math notranslate nohighlight">\(z\in[0,1]\)</span> is the dimensionless length, <span class="math notranslate nohighlight">\(Pe\)</span> is the Peclet number, <span class="math notranslate nohighlight">\(q_i\)</span> is
the concentration of species <span class="math notranslate nohighlight">\(i\)</span> in the adsorbed phase, and <span class="math notranslate nohighlight">\(\epsilon_pore\)</span> is the particle porosity. <span class="math notranslate nohighlight">\(k_{ads,i}\)</span> is
the rate constant of adsorption for component <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(Q\)</span> is the number of ligands available for adsorption and desorption,
<span class="math notranslate nohighlight">\(v_i\)</span> is the characteristic charge of component <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(k_{des,i}\)</span> is the rate constant of desorption for component <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p><strong>Reference</strong>: Sejergaard, L., Karkov, H. S., Krarup, J. K., Hagel, A. B. B., &amp; Cramer, S. M. (2014). Model‐based process
development for the purification of a modified human growth hormone using multimodal chromatography. Biotechnology
Progress,30(5), 1057-1064.</p>
</section>
</section>
</section>
<section id="n-linked-glysycolation-simulation">
<h2><a class="toc-backref" href="#id11">N-linked Glysycolation Simulation</a><a class="headerlink" href="#n-linked-glysycolation-simulation" title="Permalink to this headline"></a></h2>
<section class="tex2jax_ignore mathjax_ignore" id="steady-state-n-linked-glycosylation-simulation">
<h3><a class="toc-backref" href="#id12">Steady-State N-linked Glycosylation Simulation</a><a class="headerlink" href="#steady-state-n-linked-glycosylation-simulation" title="Permalink to this headline"></a></h3>
<p>You can simulate the steady-state N-linked Glycosylation in a perfusion bioreactor as follows</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">vLab.PerfusionSimulator.GlycosylationODESolver</span> <span class="kn">import</span> <span class="n">ODESolver</span>
<span class="kn">from</span> <span class="nn">vLab.GlycosylationModelBase.GlycosylationNetwork</span> <span class="kn">import</span> <span class="n">GlycosylationNetwork</span>
<span class="kn">from</span> <span class="nn">vLab.GlycosylationModelBase.GlycosylationModelParams</span> <span class="kn">import</span> <span class="n">CellCultureVariables</span><span class="p">,</span> <span class="n">GlycosylationModelParamClass</span>

<span class="n">fp</span> <span class="o">=</span> <span class="n">GlycosylationNetwork</span><span class="p">(</span><span class="n">network_data_path</span><span class="o">=</span><span class="s1">&#39;./data/Network Description.csv&#39;</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">GlycosylationModelParamClass</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">CellCultureVariables</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1198</span><span class="p">,</span> <span class="mf">66.3856</span><span class="p">,</span>
                         <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.490</span> <span class="o">+</span> <span class="mf">1.452</span><span class="p">,</span> <span class="mf">0.117</span> <span class="o">+</span> <span class="mf">0.379</span><span class="p">,</span> <span class="mf">0.058</span> <span class="o">+</span> <span class="mf">0.190</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span>
                         <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.62</span><span class="p">,</span> <span class="mf">0.043</span><span class="p">,</span> <span class="mf">0.1158</span><span class="p">,</span> <span class="mf">0.040</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">)</span>
<span class="c1"># compute boundary conditions</span>
<span class="n">ic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">fp</span><span class="o">.</span><span class="n">nos</span> <span class="o">+</span> <span class="n">fp</span><span class="o">.</span><span class="n">nns</span> <span class="o">+</span> <span class="n">fp</span><span class="o">.</span><span class="n">nn</span><span class="p">))</span>
<span class="n">ic</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">mabtiter</span>  <span class="c1"># umol / L</span>
<span class="n">ic</span><span class="p">[</span><span class="n">fp</span><span class="o">.</span><span class="n">nos</span><span class="p">:(</span><span class="n">fp</span><span class="o">.</span><span class="n">nos</span> <span class="o">+</span> <span class="n">fp</span><span class="o">.</span><span class="n">nns</span><span class="p">)]</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">nscyt</span> <span class="o">*</span> <span class="mi">40</span>  <span class="c1"># nucleotide sugar concentrations in umol / L.third entry is mystery</span>
<span class="n">ic</span><span class="p">[</span><span class="n">fp</span><span class="o">.</span><span class="n">nos</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">udpgalcyt</span> <span class="o">*</span> <span class="mf">1e3</span> <span class="o">*</span> <span class="mi">40</span>  <span class="c1"># updating with correct UDP-Gal concentration</span>
<span class="n">ic</span><span class="p">[(</span><span class="n">fp</span><span class="o">.</span><span class="n">nos</span> <span class="o">+</span> <span class="n">fp</span><span class="o">.</span><span class="n">nns</span><span class="p">):]</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">ncyt</span>  <span class="c1"># sum of nucleotide concentrations in umol / L</span>

</pre></div>
</div>
<p>Solve for N-glycan in the steady state operation and summarize them in major oligosaccharide residues (HM, FA1G1, FA2G0, FA2G1, FA2G2, SIA)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ode_solver</span> <span class="o">=</span> <span class="n">ODESolver</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">ic</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">fp</span><span class="p">)</span>
<span class="n">HM</span><span class="p">,</span> <span class="n">FA1G1</span><span class="p">,</span> <span class="n">FA2G0</span><span class="p">,</span> <span class="n">FA2G1</span><span class="p">,</span> <span class="n">FA2G2</span><span class="p">,</span> <span class="n">SIA</span> <span class="o">=</span> <span class="n">ode_solver</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ode_solver</span><span class="o">.</span><span class="n">os</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:10.4f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">HM</span><span class="p">,</span> <span class="n">FA1G1</span><span class="p">,</span> <span class="n">FA2G0</span><span class="p">,</span> <span class="n">FA2G1</span><span class="p">,</span> <span class="n">FA2G2</span><span class="p">,</span> <span class="n">SIA</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot the glycan distribution!</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;HM&#39;</span><span class="p">,</span> <span class="s1">&#39;FA1G1&#39;</span><span class="p">,</span> <span class="s1">&#39;FA2G0&#39;</span><span class="p">,</span> <span class="s1">&#39;FA2G1&#39;</span><span class="p">,</span> <span class="s1">&#39;FA2G2&#39;</span><span class="p">,</span> <span class="s1">&#39;SIA&#39;</span><span class="p">],</span>
        <span class="n">height</span><span class="o">=</span><span class="p">[</span><span class="n">HM</span><span class="p">,</span> <span class="n">FA1G1</span><span class="p">,</span> <span class="n">FA2G0</span><span class="p">,</span> <span class="n">FA2G1</span><span class="p">,</span> <span class="n">FA2G2</span><span class="p">,</span> <span class="n">SIA</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Glycoforms (%)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="img.png" src="../_images/glycoforms.png" /></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="dynamic-n-linked-glycosylation-simulation">
<h3><a class="toc-backref" href="#id13">Dynamic N-linked Glycosylation Simulation</a><a class="headerlink" href="#dynamic-n-linked-glycosylation-simulation" title="Permalink to this headline"></a></h3>
<p>We first load the default feed strategy from <code class="docutils literal notranslate"><span class="pre">data/states_132hours.csv</span></code>, glycosylation network from
<code class="docutils literal notranslate"><span class="pre">data/Network</span> <span class="pre">Description.csv</span></code> and glycosylation model parameters. Then we simulate the N-linked Glycosylation in a
perfusion bioreactor by initializing a new <code class="docutils literal notranslate"><span class="pre">DynamicGlycosylationSolver</span></code> class and calling method <code class="docutils literal notranslate"><span class="pre">.solve()</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">vLab.DynamicGlycosylationSimulator.Util</span> <span class="kn">import</span> <span class="n">compute_species_distribution</span>
<span class="kn">from</span> <span class="nn">vLab.GlycosylationModelBase.GlycosylationNetwork</span> <span class="kn">import</span> <span class="n">GlycosylationNetwork</span>
<span class="kn">from</span> <span class="nn">vLab.GlycosylationModelBase.GlycosylationModelParams</span> <span class="kn">import</span> <span class="n">GlycosylationModelParamClass</span>
<span class="kn">from</span> <span class="nn">vLab.DynamicGlycosylationSimulator.DynamicGlycosylationSolver</span> <span class="kn">import</span> <span class="n">DynamicGlycosylationSolver</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data/states_132hours.csv&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">fp</span> <span class="o">=</span> <span class="n">GlycosylationNetwork</span><span class="p">(</span><span class="n">network_data_path</span><span class="o">=</span><span class="s1">&#39;data/Network Description.csv&#39;</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">GlycosylationModelParamClass</span><span class="p">(</span><span class="n">is_dynamic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">DynamicGlycosylationSolver</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">states_buffer</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
<p>Plot the macroscopic viable cell density (VCD)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">tsp</span><span class="p">,</span> <span class="n">states_buffer</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">states_buffer</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;VCD&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;VCD&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;VCD ($10^6$ cells/mL)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (hr)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><img alt="img.png" src="../_images/VCD.png" /></p>
<p>Plot Mn concentration</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">tsp</span><span class="p">,</span> <span class="n">states_buffer</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">states_buffer</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Mn&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Mn&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Mn ($\mu$mol/L)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (hr)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><img alt="img.png" src="../_images/Mn.png" /></p>
<p>Solve for dynamic N-glycan distribution in a perfusion bioreactor and summarize them in major oligosaccharide residues
(HM, FA1G1, FA2G0, FA2G1, FA2G2, SIA). Then plot HM distribution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">HM</span><span class="p">,</span> <span class="n">FA1G1</span><span class="p">,</span> <span class="n">FA2G0</span><span class="p">,</span> <span class="n">FA2G1</span><span class="p">,</span> <span class="n">FA2G2</span><span class="p">,</span> <span class="n">SIA</span> <span class="o">=</span> <span class="n">compute_species_distribution</span><span class="p">(</span><span class="n">states_buffer</span><span class="p">[:,</span> <span class="mi">6</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">tsp</span><span class="p">,</span> <span class="n">HM</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;HM&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;HM&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Glycoform (%)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (hr)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><img alt="img.png" src="../_images/dynamic_glycoforms.png" /></p>
<p>Plot FA2G1 distribution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">tsp</span><span class="p">,</span> <span class="n">FA2G1</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;FA2G1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;FA2G1&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Glycoform (%)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (hr)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><img alt="img.png" src="../_images/FA2G1.png" /></p>
</section>
</section>
<section id="plantwise-simulation">
<h2><a class="toc-backref" href="#id14">Plantwise Simulation</a><a class="headerlink" href="#plantwise-simulation" title="Permalink to this headline"></a></h2>
<p>Running the plantwise simulation with initial state <code class="docutils literal notranslate"><span class="pre">x0</span></code> and default model parameters, process time
and inlet substrate concentrations</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">vLab.IntegratedBioprocess.PlantwiseSimulator</span> <span class="kn">import</span> <span class="n">PlantwiseSimulator</span>

<span class="n">X0</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># initial viable biomass concentration (g/L)</span>
<span class="n">Sg0</span> <span class="o">=</span> <span class="mi">40</span>  <span class="c1"># initial glycerol concentration (g/L)</span>
<span class="n">Sm0</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># initial methanol concentration (g/L)</span>
<span class="n">P10</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># initial product conentration (g/L)</span>
<span class="n">P20</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">P30</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">VB0</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># initial bioreactor volume (L)</span>
<span class="n">VH0</span> <span class="o">=</span> <span class="mf">1e-8</span>  <span class="c1"># initial hold tank volume (L)</span>
<span class="n">x0</span> <span class="o">=</span> <span class="p">[</span><span class="n">X0</span><span class="p">,</span> <span class="n">Sg0</span><span class="p">,</span> <span class="n">Sm0</span><span class="p">,</span> <span class="n">P10</span><span class="p">,</span> <span class="n">P20</span><span class="p">,</span> <span class="n">P30</span><span class="p">,</span> <span class="n">VB0</span><span class="p">,</span> <span class="n">P10</span><span class="p">,</span> <span class="n">P20</span><span class="p">,</span> <span class="n">P30</span><span class="p">,</span> <span class="n">VH0</span><span class="p">]</span>
<span class="n">xC0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="mi">30</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">x0</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">xC0</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">PlantwiseSimulator</span><span class="p">()</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
<span class="n">elapse_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
</pre></div>
</div>
<p>Import the <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> and <code class="docutils literal notranslate"><span class="pre">numpy</span></code> for plot</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">_process_time</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">_process_time</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Bioreactor&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Concentration (mg/mL)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (h)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Product&#39;</span><span class="p">,</span> <span class="s1">&#39;Impurity 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Impurity 2&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><img alt="img.png" src="../_images/bioreactor.png" /></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">[:,</span> <span class="mi">7</span><span class="p">:</span><span class="mi">10</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">_process_time</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">_process_time</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">_process_time</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Hold Tank&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Concentration (mg/mL)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (h)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Product&#39;</span><span class="p">,</span> <span class="s1">&#39;Impurity 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Impurity 2&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><img alt="img.png" src="../_images/harvest.png" /></p>
<p>Plot the capture step in chromatography</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tC</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">t</span> <span class="o">&gt;=</span> <span class="n">solver</span><span class="o">.</span><span class="n">_process_time</span><span class="p">[</span><span class="mi">4</span><span class="p">]]</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tC</span><span class="p">)</span>
<span class="n">xC</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span> <span class="o">&gt;=</span> <span class="n">solver</span><span class="o">.</span><span class="n">_process_time</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">11</span><span class="p">:]</span>
<span class="n">yplot</span> <span class="o">=</span> <span class="n">xC</span><span class="p">[:,</span> <span class="p">:(</span><span class="mi">30</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">311</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tC</span><span class="p">,</span> <span class="n">yplot</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Product&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Capture&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;C (mg/mL)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">312</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tC</span><span class="p">,</span> <span class="n">yplot</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Impurity 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;C (mg/mL)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">313</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tC</span><span class="p">,</span> <span class="n">yplot</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Impurity 2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;C (mg/mL)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (h)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="img.png" src="../_images/capture1.png" /></p>
<p>Plot polish step in chromatography!</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">311</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tC</span><span class="p">,</span> <span class="n">yplot</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Product&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Polish&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;C (mg/mL)&#39;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">312</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tC</span><span class="p">,</span> <span class="n">yplot</span><span class="p">[:,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Impurity 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;C (mg/mL)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">313</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tC</span><span class="p">,</span> <span class="n">yplot</span><span class="p">[:,</span> <span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Impurity 2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;C (mg/mL)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (h)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="img.png" src="../_images/polish.png" /></p>
</section>
<section id="raman-spectropecty">
<h2><a class="toc-backref" href="#id15">Raman Spectropecty</a><a class="headerlink" href="#raman-spectropecty" title="Permalink to this headline"></a></h2>
<section class="tex2jax_ignore mathjax_ignore" id="raman">
<h3><a class="toc-backref" href="#id16">Raman</a><a class="headerlink" href="#raman" title="Permalink to this headline"></a></h3>
<p>Welcome to Raman. <br>
This package is created for NIIMBL4.1 Case2. <br></p>
<p>Currently supported input files are:</p>
<ul class="simple">
<li><p>.spc</p></li>
<li><p>.dx</p></li>
<li><p>.csv</p></li>
</ul>
<p>Currently supported a set of routines to execute spectral pre-processing like:<br></p>
<ul class="simple">
<li><p>MSC</p></li>
<li><p>SNV</p></li>
<li><p>Detrend</p></li>
<li><p>Savitzky - Golay</p></li>
<li><p>Derivatives</p></li>
<li><p>..</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Import basic libraries</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">scale</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">model_selection</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">RepeatedKFold</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.cross_decomposition</span> <span class="kn">import</span> <span class="n">PLSRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>

<span class="kn">from</span> <span class="nn">src.vLab.RamanAnalytics.ReadSpc</span> <span class="kn">import</span> <span class="n">read_spc</span>
<span class="kn">from</span> <span class="nn">src.vLab.RamanAnalytics.ReadDx</span> <span class="kn">import</span> <span class="n">ReadDx</span>
<span class="kn">from</span> <span class="nn">src.vLab.RamanAnalytics.Preprocessing</span> <span class="kn">import</span> <span class="n">msc</span><span class="p">,</span> <span class="n">detrend</span><span class="p">,</span> <span class="n">sav_gol</span><span class="p">,</span> <span class="n">snv</span>
</pre></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="read-spc-file">
<h3><a class="toc-backref" href="#id17">Read .spc file</a><a class="headerlink" href="#read-spc-file" title="Permalink to this headline"></a></h3>
<section id="read-a-single-file">
<h4><a class="toc-backref" href="#id18">Read a single file</a><a class="headerlink" href="#read-a-single-file" title="Permalink to this headline"></a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">spc</span> <span class="o">=</span> <span class="n">read_spc</span><span class="p">(</span><span class="s1">&#39;VIAVI/JDSU_Phar_Rotate_S06_1_20171009_1540.spc&#39;</span><span class="p">)</span>
<span class="n">spc</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;nm&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Abs&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">spc</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>gx-y(1)
908.100000    0.123968
914.294355    0.118613
920.488710    0.113342
926.683065    0.108641
932.877419    0.098678
dtype: float64
</pre></div>
</div>
<p><img alt="image" src="https://user-images.githubusercontent.com/56982084/163854218-c5a8407e-2d36-4ab2-8a2c-13aef19c5341.png" /></p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="read-dx-spectral-files">
<h3><a class="toc-backref" href="#id19">Read .dx spectral files</a><a class="headerlink" href="#read-dx-spectral-files" title="Permalink to this headline"></a></h3>
<p>Raman also allows to read the most common .dx file formats</p>
<section id="read-a-single-dx-file">
<h4><a class="toc-backref" href="#id20">Read a single .dx file</a><a class="headerlink" href="#read-a-single-dx-file" title="Permalink to this headline"></a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Foss_single</span> <span class="o">=</span> <span class="n">read_dx</span><span class="p">()</span>
<span class="c1"># Run read method</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">Foss_single</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;../../data/FOSS/FOSS.dx&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="image" src="https://user-images.githubusercontent.com/56982084/163855034-65caff70-aec4-4fef-b022-9acf08699bbe.png" /></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">Foss_single</span><span class="o">.</span><span class="n">Samples</span><span class="p">[</span><span class="s1">&#39;29179&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>y
Conc
TITLE
JCAMP_DX
DATA TYPE
CLASS
DATE
DATA PROCESSING
XUNITS
YUNITS
XFACTOR
YFACTOR
FIRSTX
LASTX
MINY
MAXY
NPOINTS
FIRSTY
CONCENTRATIONS
XYDATA
X
Y
</pre></div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="read-csv-files">
<h3><a class="toc-backref" href="#id21">Read .csv files</a><a class="headerlink" href="#read-csv-files" title="Permalink to this headline"></a></h3>
<p>Raman also allows to read .csv file</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/RamanRaw.csv&#39;</span><span class="p">)</span>

    <span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">301</span><span class="p">:</span><span class="mi">1702</span><span class="p">]]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]]</span>
</pre></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="spectra-preprocessing">
<h3><a class="toc-backref" href="#id22">Spectra preprocessing</a><a class="headerlink" href="#spectra-preprocessing" title="Permalink to this headline"></a></h3>
<p>A set of built in classes to perform spectra pre-processing like: <br></p>
<ul class="simple">
<li><p>MSC: Multiplicative scattering correction</p></li>
<li><p>SNV: Standard normal variate</p></li>
<li><p>Detrend</p></li>
<li><p>n order derivative</p></li>
<li><p>Savitzky golay smmothing</p></li>
</ul>
<section id="msc">
<h4><a class="toc-backref" href="#id23">MSC</a><a class="headerlink" href="#msc" title="Permalink to this headline"></a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">MSC</span> <span class="o">=</span> <span class="n">msc</span><span class="p">()</span>
<span class="n">MSC</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">X_msc</span> <span class="o">=</span> <span class="n">MSC</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">X</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Raw spectra&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">bottom</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">top</span> <span class="o">=</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;RamanShift(cm-1)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Counts&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">X_msc</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MSC spectra&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">bottom</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">top</span> <span class="o">=</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;RamanShift(cm-1)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Counts&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><img alt="image" src="https://user-images.githubusercontent.com/56982084/171699029-aa8b4746-bfcb-4247-b46c-9fc097735107.png" /></p>
<p><img alt="image" src="https://user-images.githubusercontent.com/56982084/171699048-d6d2243c-df1e-41e0-a98c-288108596dbb.png" /></p>
</section>
<section id="snv-and-detrend">
<h4><a class="toc-backref" href="#id24">SNV and Detrend</a><a class="headerlink" href="#snv-and-detrend" title="Permalink to this headline"></a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SNV</span> <span class="o">=</span> <span class="n">snv</span><span class="p">()</span>
<span class="n">X_snv</span> <span class="o">=</span> <span class="n">SNV</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">Detr</span> <span class="o">=</span> <span class="n">detrend</span><span class="p">()</span>
<span class="n">X_detrend</span> <span class="o">=</span> <span class="n">Detr</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">spc</span><span class="o">=</span><span class="n">X_snv</span><span class="p">,</span> <span class="n">wave</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_snv</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)),</span> <span class="n">deg</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">X</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Raw spectra&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">bottom</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">top</span> <span class="o">=</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;RamanShift(cm-1)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Counts&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">X_snv</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;SNV spectra&quot;</span><span class="p">)</span>
<span class="c1">#plt.ylim(bottom = 0, top = 2.5 * 10**6)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;RamanShift(cm-1)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Counts&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">X_detrend</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;SNV+ Detrend spectra&quot;</span><span class="p">)</span>
<span class="c1">#plt.ylim(bottom = 0, top = 2.5 * 10**6)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;RamanShift(cm-1)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Counts&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><img alt="image" src="https://user-images.githubusercontent.com/56982084/171699288-78f47aa5-fc83-4f61-8f45-9963e89a6d2c.png" />
<img alt="image" src="https://user-images.githubusercontent.com/56982084/171699300-667279eb-b849-4e97-a84b-30908a5237e5.png" />
<img alt="image" src="https://user-images.githubusercontent.com/56982084/171699311-cdd63bb0-43b4-429a-8fd8-57a413ca28db.png" /></p>
</section>
<section id="savitzky-golay">
<h4><a class="toc-backref" href="#id25">Savitzky - Golay</a><a class="headerlink" href="#savitzky-golay" title="Permalink to this headline"></a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SAV_gol</span> <span class="o">=</span> <span class="n">sav_gol</span><span class="p">()</span>
<span class="n">X_SAV</span> <span class="o">=</span> <span class="n">SAV_gol</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">X</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Raw spectra&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">bottom</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">top</span> <span class="o">=</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;RamanShift(cm-1)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Counts&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">X_snv</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Savitzky golay smmothing spectra&quot;</span><span class="p">)</span>
<span class="c1">#plt.ylim(bottom = 0, top = 2.5 * 10**6)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;RamanShift(cm-1)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Counts&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><img alt="image" src="https://user-images.githubusercontent.com/56982084/171699461-bb22831b-eae5-4ee0-8455-58e1e65f19e2.png" />
<img alt="image" src="https://user-images.githubusercontent.com/56982084/171699468-c040a4d3-1036-40b4-8639-2a9ddfadfdea.png" /></p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="split-the-dataset">
<h3><a class="toc-backref" href="#id26">Split The Dataset</a><a class="headerlink" href="#split-the-dataset" title="Permalink to this headline"></a></h3>
<section id="split-the-dataset-into-training-70-and-testing-30-sets">
<h4><a class="toc-backref" href="#id27">split the dataset into training (70%) and testing (30%) sets</a><a class="headerlink" href="#split-the-dataset-into-training-70-and-testing-30-sets" title="Permalink to this headline"></a></h4>
<p>We now split the samples into a training set and a test set in order to estimate the test error from different methods.
In this part, we use the pre-processed raman data via SNV and Detrend as example. The concentration of glucose is target variable.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_all_train</span><span class="p">,</span> <span class="n">y_all_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_detrend</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">Metabolites</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="s1">&#39;Glucose&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Lactate&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;Glutamine&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;NH4&#39;</span><span class="p">}</span>
<span class="c1">#0:GLuc; 1: Lac; 2:Gln; 3: NH4;</span>
<span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span>  <span class="n">y_all_train</span><span class="p">[</span><span class="n">y</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">index</span><span class="p">]]</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(),</span> <span class="n">y_all_test</span><span class="p">[</span><span class="n">y</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">index</span><span class="p">]]</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="raman-spectra-data-analysis">
<h3><a class="toc-backref" href="#id28">Raman Spectra Data Analysis</a><a class="headerlink" href="#raman-spectra-data-analysis" title="Permalink to this headline"></a></h3>
<section id="ridge-regression">
<h4><a class="toc-backref" href="#id29">Ridge Regression</a><a class="headerlink" href="#ridge-regression" title="Permalink to this headline"></a></h4>
<p>We fit a ridge regression model on the training set. Without given any value of Regularization strength. The function will implement cross validation to find optimal value of it with the smallest validation error.</p>
<p>The output includings:</p>
<ol class="arabic simple">
<li><p>Visualization of regression coefficients</p></li>
<li><p>Regression results on the training data</p></li>
<li><p>Regression results on the test data</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rr</span> <span class="o">=</span> <span class="n">RR</span><span class="p">()</span>
<span class="n">rr</span><span class="o">.</span><span class="n">analysis</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">Metabolites</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
</pre></div>
</div>
<p><img alt="image" src="https://user-images.githubusercontent.com/56982084/171699875-c9d280a8-b8de-4b46-b68d-f9075ab17ea5.png" />
<img alt="image" src="https://user-images.githubusercontent.com/56982084/171699890-4a911f36-ea0b-446a-983e-a359679c6046.png" />
<img alt="image" src="https://user-images.githubusercontent.com/56982084/171699900-b358d97d-b353-455b-bf2d-cfbee1c67da8.png" /></p>
</section>
<section id="lasso-regression">
<h4><a class="toc-backref" href="#id30">Lasso Regression</a><a class="headerlink" href="#lasso-regression" title="Permalink to this headline"></a></h4>
<p>We fit a Lasso regression model on the training set. Without given any value of Regularization strength. The function will implement cross validation to find optimal value of it with the smallest validation error.</p>
<p>The output includings:</p>
<ol class="arabic simple">
<li><p>Visualization of regression coefficients</p></li>
<li><p>Regression results on the training data</p></li>
<li><p>Regression results on the test data</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">la</span> <span class="o">=</span> <span class="n">LA</span><span class="p">()</span>
<span class="n">la</span><span class="o">.</span><span class="n">analysis</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">Metabolites</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
</pre></div>
</div>
<p><img alt="image" src="https://user-images.githubusercontent.com/56982084/171700170-4778cca4-6c95-44b9-9049-df7f8193b5fe.png" />
<img alt="image" src="https://user-images.githubusercontent.com/56982084/171700186-7e2483e8-bb68-4822-8d20-950ed3688cdf.png" />
<img alt="image" src="https://user-images.githubusercontent.com/56982084/171700203-dd8e2a40-2502-4a7a-a0a2-fa4564bc3cd9.png" /></p>
<p>We fit a Elastic Net model on the training set. Without given any value of Regularization strength. The function will implement cross validation to find optimal value of it with the smallest validation error.</p>
<p>The output includings:</p>
<ol class="arabic simple">
<li><p>Visualization of regression coefficients</p></li>
<li><p>Regression results on the training data</p></li>
<li><p>Regression results on the test data</p></li>
</ol>
</section>
<section id="elastic-net">
<h4><a class="toc-backref" href="#id31">Elastic Net</a><a class="headerlink" href="#elastic-net" title="Permalink to this headline"></a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">en</span> <span class="o">=</span> <span class="n">EN</span><span class="p">()</span>
<span class="n">en</span><span class="o">.</span><span class="n">analysis</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">Metabolites</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
</pre></div>
</div>
<p><img alt="image" src="https://user-images.githubusercontent.com/56982084/171700458-1a1085eb-feed-4d5f-b2d1-5480fe51ebe2.png" />
<img alt="image" src="https://user-images.githubusercontent.com/56982084/171700466-75d99417-87ce-48d4-b1e0-c8f611c85d32.png" />
<img alt="image" src="https://user-images.githubusercontent.com/56982084/171700478-999adb98-abaf-468c-893f-9fe2d8bc235c.png" /></p>
</section>
<section id="principal-components-regression">
<h4><a class="toc-backref" href="#id32">Principal Components Regression</a><a class="headerlink" href="#principal-components-regression" title="Permalink to this headline"></a></h4>
<p>We fit Principal Components Regression on the training set. Without given any number of principal component to keep. The function will implement cross validation to find optimal value of it with the smallest validation error.</p>
<p>The output includings:</p>
<ol class="arabic simple">
<li><p>Visualization of regression coefficients</p></li>
<li><p>Regression results on the training data</p></li>
<li><p>Regression results on the test data</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pcr</span> <span class="o">=</span> <span class="n">PCR</span><span class="p">()</span>
<span class="n">pcr</span><span class="o">.</span><span class="n">analysis</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">Metabolites</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
</pre></div>
</div>
<p><img alt="image" src="https://user-images.githubusercontent.com/56982084/171700543-24cef100-b61c-48ef-b715-651426fb1b4f.png" />
<img alt="image" src="https://user-images.githubusercontent.com/56982084/171700551-f124ca12-f5b9-4e1b-8ab6-a8fd2521b1b9.png" />
<img alt="image" src="https://user-images.githubusercontent.com/56982084/171700560-5a2304df-a26b-4377-8657-22709af790c6.png" /></p>
</section>
<section id="partial-least-squares-pls-regression">
<h4><a class="toc-backref" href="#id33">Partial least-squares (PLS) regression</a><a class="headerlink" href="#partial-least-squares-pls-regression" title="Permalink to this headline"></a></h4>
<p>We fit Partial least-squares (PLS) regression on the training set. Without given any number of principal component to keep. The function will implement cross validation to find optimal value of it with the smallest validation error.</p>
<p>The output includings:</p>
<ol class="arabic simple">
<li><p>Visualization of regression coefficients</p></li>
<li><p>Regression results on the training data</p></li>
<li><p>Regression results on the test data</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pls</span> <span class="o">=</span> <span class="n">PLS</span><span class="p">()</span>
<span class="n">pls</span><span class="o">.</span><span class="n">analysis</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">Metabolites</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
</pre></div>
</div>
<p><img alt="image" src="https://user-images.githubusercontent.com/56982084/171700723-4786f9f5-85f4-49d6-9280-8845aff8fc38.png" />
<img alt="image" src="https://user-images.githubusercontent.com/56982084/171700734-a312b931-dc3f-4029-a67b-5082ff67bad6.png" />
<img alt="image" src="https://user-images.githubusercontent.com/56982084/171700746-16a423cc-a0e6-4d33-8ee6-57634aee433d.png" /></p>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../TrainingMaterial/StatisticalModel/statistical_model.html" class="btn btn-neutral float-left" title="Statistical Modeling" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../IntegratedBioprocess/Bioreactor.html" class="btn btn-neutral float-right" title="Bioreactor module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, NIIMBL PC4.1-206 .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>